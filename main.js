!function(){"use strict";class e{constructor(e,t){this._settings=e,this._form=t}_showInputError(e,t){const s=this._form.querySelector(".".concat(e.id,"-error"));e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hideInputError(e){const t=this._form.querySelector(".".concat(e.id,"-error"));e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent=""}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_toggleButtonState(){this._hasInvalidInput()?(this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)):(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.removeAttribute("disabled"))}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._settings.inputSelector)),this._buttonElement=this._form.querySelector(this._settings.submitButtonSelector),this._toggleButtonState(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}enableValidation(){this._setEventListeners(),this._form.addEventListener("submit",(function(e){e.preventDefault()}))}}function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class s{constructor(e,s,o,n,i){let{_id:r,name:a,link:l,likes:c}=e;t(this,"_handleLikeEvent",(()=>{this._likeButton.classList.contains("photo-card__like-button_active")?this._handleLikeClick(this,!1):this._handleLikeClick(this,!0)})),t(this,"_handleDeleteEvent",(()=>{this._handleDeleteCardClick(this)})),this._id=r,this._name=a,this._image=l,this._likes=c,this._cardSelector=s,this._handleCardClick=o,this._handleDeleteCardClick=n,this._handleLikeClick=i}getId(){return this._id}getName(){return this._name}getImageLink(){return this._image}createCard(){return this._element=this._createNewPhotoCardElement(),this._likeButton=this._element.querySelector(".photo-card__like-button"),this._deleteButton=this._element.querySelector(".photo-card__delete-button"),this._photo=this._element.querySelector(".photo-card__photo"),this._addEventListeners(),this._element}deleteCard(){this._element.remove(),this._element=null}updateLikes(e,t){this._likes=e,this._element.querySelector(".photo-card__like-count").textContent=this._likes.length,JSON.stringify(this._likes).includes(t)?this._likeButton.classList.add("photo-card__like-button_active"):this._likeButton.classList.remove("photo-card__like-button_active")}_addEventListeners(){this._addLikeEventListener(),this._addDeleteEventListener(),this._addOpenPhotoEventListener()}_createNewPhotoCardElement(){const e=this._cardSelector.querySelector(".photo-card").cloneNode(!0),t=e.querySelector(".photo-card__photo"),s=e.querySelector(".photo-card__title"),o=e.querySelector(".photo-card__like-count");return t.src=this._image,t.alt=this._name,s.textContent=this._name,o.textContent=this._likes.length,e}_addLikeEventListener(){this._likeButton.addEventListener("click",this._handleLikeEvent)}_addDeleteEventListener(){this._deleteButton.addEventListener("click",this._handleDeleteEvent)}_addOpenPhotoEventListener(){this._photo.addEventListener("click",(()=>{this._handleCardClick(this)}))}}function o(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class n{constructor(e){o(this,"_handleEscClose",(e=>{"Escape"==e.key&&this.close()})),o(this,"_handleClickOnOverlayClose",(e=>{e.target.classList.contains("popup")&&this.close()})),this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close-button"),this.close=this.close.bind(this)}open(){this._popup.classList.add("popup_opened"),this.setEventListeners()}close(){this._popup.classList.remove("popup_opened"),this.removeEventListeners()}setEventListeners(){document.addEventListener("click",this._handleClickOnOverlayClose),document.addEventListener("keydown",this._handleEscClose),this._closeButton.addEventListener("click",this.close)}removeEventListeners(){document.removeEventListener("click",this._handleClickOnOverlayClose),document.removeEventListener("keydown",this._handleEscClose),this._closeButton.removeEventListener("click",close)}}class i extends n{constructor(e,t){var s,o;super(e),o=e=>{e.preventDefault(),this._handleSubmit(this,this._getInputValues())},(s="_handleProfileFormSubmit")in this?Object.defineProperty(this,s,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[s]=o,this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._popup.querySelector(".form__submit-button"),this._inputs=Array.from(this._popup.querySelectorAll(".form__text-input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.getAttribute("name")]=t.value})),e}setButtonText(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Saving...";this._submitButton.textContent=e}setEventListeners(){this._form.addEventListener("submit",this._handleProfileFormSubmit),super.setEventListeners()}removeEventListeners(){this._form.removeEventListener("submit",this._handleProfileFormSubmit),super.removeEventListeners()}close(){this._form.reset(),super.close()}}class r{constructor(e,t){let{items:s,renderer:o}=e;this._items=s,this._renderer=o,this._container=document.querySelector(t)}clear(){this._container.innerHTML=""}renderer(){this.clear(),this._items.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}const a=document.querySelector(".popup-edit"),l=document.querySelector(".popup-add"),c=document.querySelector(".popup-photo"),h=document.querySelector(".popup-delete"),u=document.querySelector(".popup-edit-avatar"),_=(a.querySelector(".popup__close-button"),l.querySelector(".popup__close-button"),c.querySelector(".popup__close-button"),h.querySelector(".popup__close-button"),u.querySelector(".popup__close-button"),a.querySelector(".form")),d=_.querySelector('.form__text-input[name="name"]'),p=_.querySelector('.form__text-input[name="about-me"]'),m=l.querySelector(".form"),v=(m.querySelector('.form__text-input[name="title"]'),m.querySelector('.form__text-input[name="image-link"]'),u.querySelector(".form").querySelector('.form__text-input[name="avatar-link"]'),document.querySelector(".profile")),f=v.querySelector(".profile__edit-button"),b=v.querySelector(".profile__add-button"),S=v.querySelector(".profile__photo-edit-button"),k=document.querySelector("#photo-card__template").content,y=new Map,E={formSelector:".form",inputSelector:".form__text-input",submitButtonSelector:".form__submit-button",inactiveButtonClass:"form__submit-button_disabled",inputErrorClass:"form__text-input-error_active",errorClass:"form__input-error_visible"};let g;function L(e){const t=new s(e,k,C,q,I),o=t.createCard();return t.updateLikes(t._likes,B._id),o}function C(e){O.open(e.getImageLink(),e.getName())}function q(e){T.open(),g=e}function I(e,t){t?x.addLike(e.getId()).then((t=>{console.log("Like added succesfully",t.likes),e.updateLikes(t.likes,B.getId())})).catch((e=>{console.log(e)})):x.removeLike(e.getId()).then((t=>{console.log("Like removed succesfully",t.likes),e.updateLikes(t.likes,B.getId())})).catch((e=>{console.log(e)}))}const x=new class{constructor(e){this._options=e}getInitialCards(){return fetch(this._options.baseUrl+"/cards/",{headers:this._options.headers}).then(this._checkResponse)}setNewCard(e){let{cardName:t,cardLink:s}=e;return fetch(this._options.baseUrl+"/cards/",{method:"POST",headers:this._options.headers,body:JSON.stringify({name:t,link:s})}).then(this._checkResponse)}addLike(e){return fetch(this._options.baseUrl+"/cards/likes/"+e,{method:"PUT",headers:this._options.headers}).then(this._checkResponse)}removeLike(e){return fetch(this._options.baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:this._options.headers}).then(this._checkResponse)}deleteCard(e){return fetch(this._options.baseUrl+"/cards/"+e,{method:"DELETE",headers:this._options.headers}).then(this._checkResponse)}getUserInfo(){return fetch(this._options.baseUrl+"/users/me",{headers:this._options.headers}).then(this._checkResponse)}setUserInfo(e){let{newName:t,newAbout:s}=e;return fetch(this._options.baseUrl+"/users/me",{method:"PATCH",headers:this._options.headers,body:JSON.stringify({name:t,about:s})}).then(this._checkResponse)}updateAvatar(e){return fetch(this._options.baseUrl+"/users/me/avatar",{method:"PATCH",headers:this._options.headers,body:JSON.stringify({avatar:e})}).then(this._checkResponse)}_checkResponse(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"b9d1c3b6-c0f4-4224-ad8f-4c81efa3f89d","Content-Type":"application/json"}}),B=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:o}=e;this._nameSelector=t,this._jobSelector=s,this._avatarSelector=o,this._nameElement=document.querySelector(this._nameSelector),this._jobElement=document.querySelector(this._jobSelector),this._avatarElement=document.querySelector(this._avatarSelector)}getId(){return this._id?this._id:null}getUserInfo(){return{name:this._nameElement.textContent,job:this._jobElement.textContent,avatar:this._avatarElement.src}}setUserInfo(e){let{name:t,about:s,_id:o,avatar:n}=e;this._nameElement.textContent=t,this._jobElement.textContent=s,this._avatarElement=n,this._id=o}}({nameSelector:".profile__name",jobSelector:".profile__description",avatarSelector:".profile__photo"});let w;Promise.all([x.getUserInfo(),x.getInitialCards()]).then((e=>{let[t,s]=e;B.setUserInfo(t),w=new r({items:s,renderer:L},".photos__grid"),w.renderer()})).catch((e=>{console.log(e)}));const U=new i(".popup-add",(function(e,t){const s={cardName:t.title,cardLink:t["image-link"]};e.setButtonText("Saving..."),x.setNewCard(s).then((t=>{w.addItem(t),e.close()})).catch((e=>{console.log(e)})).finally((()=>{e.setButtonText("Create")}))})),A=new i(".popup-edit",(function(e,t){e.setButtonText("Saving..."),x.setUserInfo({newName:t.name,newAbout:t["about-me"]}).then((t=>{B.setUserInfo(t),e.close()})).catch((e=>{console.log(e)})).finally((()=>{e.setButtonText("Save")}))})),T=new i(".popup-delete",(function(e){e.setButtonText("Deleting..."),x.deleteCard(g.getId()).then((()=>{g.deleteCard(),g=null,e.close()})).catch((e=>{console.log(e)})).finally((()=>{e.setButtonText("Yes")}))})),O=new class extends n{constructor(e){super(e),this._photoContainer=this._popup.querySelector(".popup-photo__container"),this._photo=this._photoContainer.querySelector(".popup-photo__photo"),this._title=this._photoContainer.querySelector(".popup-photo__title")}open(e,t){this._photo.src=e,this._title.textContent=t,this._photo.alt=t,super.open()}}(".popup-photo"),P=new i(".popup-edit-avatar",(function(e,t){e.setButtonText("Saving..."),x.updateAvatar(t["avatar-link"]).then((t=>{console.log("Avatar updated ",t),B.setUserInfo(t),e.close()})).catch((e=>{console.log(e)})).finally((()=>{e.setButtonText("Save")}))}));Array.from(document.querySelectorAll(E.formSelector)).forEach((t=>{const s=t.getAttribute("name"),o=new e(E,t);o.enableValidation(),y.set(s,o)})),b.addEventListener("click",(()=>{U.open(),y.get("add-form").resetValidation()})),f.addEventListener("click",(()=>{const e=B.getUserInfo();d.value=e.name,p.value=e.job,A.open(),y.get("edit-form").resetValidation()})),S.addEventListener("click",(()=>{P.open(),y.get("edit-avatar-form").resetValidation()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SCxFQUFBQSxJQUFvQmlFLEVBQVVDLE1BaURsQ2xFLEVBQUFBLGlCQUFxQyxTQUFTLEtBQzVDc0QsRUFBUzlHLE9BQ1R3RCxFQUFBQSxJRDlLeUIsWUM4S2tCbkgscUJBSzdDbUgsRUFBQUEsaUJBQXNDLFNBQVMsS0FDN0MsTUFBTW1FLEVBQWtCakUsRUFBU3lCLGNBQ2pDM0IsRUFBQUEsTUFBNEJtRSxFQUFnQjVLLEtBQzVDeUcsRUFBQUEsTUFBbUNtRSxFQUFnQmxCLElBQ25EVSxFQUFVbkgsT0FDVndELEVBQUFBLElEekwwQixhQ3lMa0JuSCxxQkFLOUNtSCxFQUFBQSxpQkFBNEMsU0FBUyxLQUNuRCtELEVBQWdCdkgsT0FDaEJ3RCxFQUFBQSxJRDdMZ0Msb0JDNkxrQm5ILHFCIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZS9pbmRleC5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pe1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgZXJyb3JNZXNzYWdlKSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICB9O1xyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfTtcclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhc0ludmFsaWRJbnB1dCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3Quc29tZSgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHJldHVybiAhaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5zZXRBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiLCB0cnVlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKSk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3NldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuXHJcbiAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy5fdG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9O1xyXG5cclxuICByZXNldFZhbGlkYXRpb24oKXtcclxuICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGZ1bmN0aW9uIChldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICB9O1xyXG59XHJcblxyXG5cclxuZXhwb3J0IHtGb3JtVmFsaWRhdG9yfTtcclxuIiwiY2xhc3MgQ2FyZCB7XHJcblxyXG4gICAgY29uc3RydWN0b3IoeyBfaWQsIG5hbWUsIGxpbmssIGxpa2VzIH0sIGNhcmRTZWxlY3RvciwgaGFuZGxlQ2FyZENsaWNrLCBoYW5kbGVEZWxldGVDYXJkQ2xpY2ssIGhhbmRsZUxpa2VDbGljaykge1xyXG5cclxuICAgICAgICB0aGlzLl9pZCA9IF9pZDtcclxuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9pbWFnZSA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgICAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmRDbGljayA9IGhhbmRsZURlbGV0ZUNhcmRDbGljaztcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SWQoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9pZDtcclxuICAgIH1cclxuXHJcbiAgICBnZXROYW1lKCkge1xyXG4gICAgICByZXR1cm4gdGhpcy5fbmFtZTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRJbWFnZUxpbmsoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9pbWFnZTtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIENyZWF0ZXMgb25lIHNpbmdsZSBwaG90byBjYXJkIHdpdGggc3BlY2lmaWVkIGNhcmQgaW5mb3JtYXRpb24gKG9iamVjdClcclxuICAgICAqIEBwYXJhbSB7b2JqZWN0fSBjYXJkXHJcbiAgICAgKiBAcmV0dXJucyBwaG90b0NhcmQgdG8gYmUgcmVuZGVyZWRcclxuICAgICAqL1xyXG4gICAgY3JlYXRlQ2FyZCgpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX2NyZWF0ZU5ld1Bob3RvQ2FyZEVsZW1lbnQoKTtcclxuICAgICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5waG90by1jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNhcmRfX2RlbGV0ZS1idXR0b25cIik7XHJcbiAgICAgIHRoaXMuX3Bob3RvID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNhcmRfX3Bob3RvXCIpO1xyXG4gICAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcclxuICAgICAgdGhpcy5fZWxlbWVudCA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgdXBkYXRlTGlrZXMobGlrZXMsIHVzZXJJZCkge1xyXG4gICAgICB0aGlzLl9saWtlcyA9IGxpa2VzO1xyXG5cclxuICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNhcmRfX2xpa2UtY291bnRcIikudGV4dENvbnRlbnQgPSB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgICBpZihKU09OLnN0cmluZ2lmeSh0aGlzLl9saWtlcykuaW5jbHVkZXModXNlcklkKSkge1xyXG4gICAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LmFkZCgncGhvdG8tY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlJyk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdwaG90by1jYXJkX19saWtlLWJ1dHRvbl9hY3RpdmUnKTtcclxuICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBfYWRkRXZlbnRMaXN0ZW5lcnMoKXtcclxuXHJcbiAgICAgICAgdGhpcy5fYWRkTGlrZUV2ZW50TGlzdGVuZXIoKTtcclxuICAgICAgICB0aGlzLl9hZGREZWxldGVFdmVudExpc3RlbmVyKCk7XHJcbiAgICAgICAgdGhpcy5fYWRkT3BlblBob3RvRXZlbnRMaXN0ZW5lcigpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVOZXdQaG90b0NhcmRFbGVtZW50KCkge1xyXG4gICAgICAgIGNvbnN0IHBob3RvQ2FyZCA9IHRoaXMuX2NhcmRTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuICAgICAgICBjb25zdCBwaG90byA9IHBob3RvQ2FyZC5xdWVyeVNlbGVjdG9yKFwiLnBob3RvLWNhcmRfX3Bob3RvXCIpO1xyXG4gICAgICAgIGNvbnN0IHBob3RvVGl0bGUgPSBwaG90b0NhcmQucXVlcnlTZWxlY3RvcihcIi5waG90by1jYXJkX190aXRsZVwiKTtcclxuICAgICAgICBjb25zdCBwaG90b0xpa2VzID0gcGhvdG9DYXJkLnF1ZXJ5U2VsZWN0b3IoXCIucGhvdG8tY2FyZF9fbGlrZS1jb3VudFwiKTtcclxuXHJcbiAgICAgICAgcGhvdG8uc3JjID0gdGhpcy5faW1hZ2U7XHJcbiAgICAgICAgcGhvdG8uYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICBwaG90b1RpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgICAgICBwaG90b0xpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgICAgICByZXR1cm4gcGhvdG9DYXJkO1xyXG4gICAgfVxyXG5cclxuICAgIC8qXHJcbiAgICBLZWVwaW5nIGNvbW1lbnQgZm9yIGxlYXJuaW5nIHB1cnBvc2VzXHJcbiAgICBkZWNsYXJlIG1ldGhvZHMgYXMgYXJyb3cgZnVuY3Rpb25zIHRvIG5vdCBsb3NlIGNvbnRleHQgYHRoaXNgLiBgdGhpc2AgaXMgQ2FyZCBpbnN0YW5jZSBoZXJlXHJcbiAgICAqL1xyXG4gICAgX2hhbmRsZUxpa2VFdmVudCA9ICgpID0+IHtcclxuICAgICAgaWYodGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoJ3Bob3RvLWNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZScpKSB7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMsIGZhbHNlKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sodGhpcywgdHJ1ZSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfYWRkTGlrZUV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VFdmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZURlbGV0ZUV2ZW50ID0gKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkQ2xpY2sodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZERlbGV0ZUV2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fZGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVEZWxldGVFdmVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZE9wZW5QaG90b0V2ZW50TGlzdGVuZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fcGhvdG8uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn1cclxuXHJcbmV4cG9ydCB7Q2FyZH1cclxuIiwiY2xhc3MgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJyk7XHJcbiAgICAgICAgdGhpcy5jbG9zZSA9IHRoaXMuY2xvc2UuYmluZCh0aGlzKTsgLy9CZXR0ZXIgYmluZCB0aGFuIGRlZmluaW5nIGNsb3NlIGFzIGFuIGFycm93IGZ1bmN0aW9uIEkgZ3Vlc3M/XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsaWNrT25PdmVybGF5Q2xvc2UpO1xyXG4gICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsaWNrT25PdmVybGF5Q2xvc2UpO1xyXG4gICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBjbG9zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmKGV2dC5rZXkgPT0gXCJFc2NhcGVcIil7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUNsaWNrT25PdmVybGF5Q2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cFwiKSl7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgfVxyXG5cclxufVxyXG5cclxuZXhwb3J0IHtQb3B1cH07XHJcbiIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVTdWJtaXQpIHtcclxuICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IGhhbmRsZVN1Ym1pdDtcclxuICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX19zdWJtaXQtYnV0dG9uJyk7XHJcbiAgICAgIHRoaXMuX2lucHV0cyA9IEFycmF5LmZyb20odGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvckFsbChcIi5mb3JtX190ZXh0LWlucHV0XCIpKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XHJcbiAgICAgICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuXHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0VmFsdWVzW2lucHV0LmdldEF0dHJpYnV0ZSgnbmFtZScpXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgICB9XHJcblxyXG4gICAgc2V0QnV0dG9uVGV4dCh0ZXh0PVwiU2F2aW5nLi4uXCIpIHtcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0KTtcclxuICAgICAgc3VwZXIucmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9mb3JtLnJlc2V0KCk7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQgPSAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVTdWJtaXQodGhpcywgdGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCB7IFBvcHVwV2l0aEZvcm0gfVxyXG4iLCJjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKCB7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XHJcbiAgICAgICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGNvbnRhaW5lclNlbGVjdG9yKTtcclxuICAgIH1cclxuXHJcbiAgICBjbGVhcigpIHtcclxuICAgICAgICB0aGlzLl9jb250YWluZXIuaW5uZXJIVE1MID0gXCJcIjtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJlcigpIHtcclxuICAgICAgICB0aGlzLmNsZWFyKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICB0aGlzLmFkZEl0ZW0oaXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZCA9IHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmQpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQge1NlY3Rpb259XHJcbiIsImV4cG9ydCBjb25zdCB1c2VyU2VsZWN0b3JzID0ge1xyXG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19waG90b1wiXHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgaW5pdGlhbFVzZXJJbmZvID0ge1xyXG4gIG5ld05hbWU6IFwiSmFjcXVlcyBDb3VzdGVhdVwiLFxyXG4gIG5ld0pvYjogXCJFeHBsb3JlclwiXHJcbn07XHJcblxyXG4vKiogRGVjbGFyYXRpb24gb2YgdGhlIFBvcHVwcyAqL1xyXG5leHBvcnQgY29uc3QgcG9wdXBFZGl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWVkaXQnKTtcclxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwLWFkZCcpO1xyXG5leHBvcnQgY29uc3QgcG9wdXBQaG90byA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1waG90bycpO1xyXG5leHBvcnQgY29uc3QgcG9wdXBEZWxldGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtZGVsZXRlJylcclxuZXhwb3J0IGNvbnN0IHBvcHVwRWRpdEF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cC1lZGl0LWF2YXRhcicpO1xyXG5cclxuLyoqIERlY2xhcmF0aW9uIG9mIHRoZSBDbG9zZSBCdXR0b25zICovXHJcbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbkVkaXQgPSBwb3B1cEVkaXQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZS1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNsb3NlQnV0dG9uQWRkID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZS1idXR0b24nKTtcclxuZXhwb3J0IGNvbnN0IGNsb3NlQnV0dG9uUGhvdG8gPSBwb3B1cFBob3RvLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbkRlbGV0ZSA9IHBvcHVwRGVsZXRlLnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2xvc2UtYnV0dG9uJyk7XHJcbmV4cG9ydCBjb25zdCBjbG9zZUJ1dHRvbkVkaXRBdmF0YXIgPSBwb3B1cEVkaXRBdmF0YXIucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZS1idXR0b24nKTtcclxuXHJcbi8qKiBEZWNsYXJhdGlvbiBvZiB0aGUgRm9ybXMgKi9cclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtRWRpdE5hbWUgPSAnZWRpdC1mb3JtJztcclxuZXhwb3J0IGNvbnN0IGZvcm1BZGROYW1lID0gJ2FkZC1mb3JtJztcclxuZXhwb3J0IGNvbnN0IGZvcm1EZWxldGVOYW1lID0gJ2RlbGV0ZS1mb3JtJztcclxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0QXZhdGFyTmFtZSA9ICdlZGl0LWF2YXRhci1mb3JtJztcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtRWRpdCA9IHBvcHVwRWRpdC5xdWVyeVNlbGVjdG9yKCcuZm9ybScpO1xyXG5leHBvcnQgY29uc3QgbmFtZUlucHV0ID0gZm9ybUVkaXQucXVlcnlTZWxlY3RvcignLmZvcm1fX3RleHQtaW5wdXRbbmFtZT1cIm5hbWVcIl0nKTtcclxuZXhwb3J0IGNvbnN0IGRlc2NyaXB0aW9uSW5wdXQgPSBmb3JtRWRpdC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fdGV4dC1pbnB1dFtuYW1lPVwiYWJvdXQtbWVcIl0nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBmb3JtQWRkID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLmZvcm0nKTtcclxuZXhwb3J0IGNvbnN0IHRpdGxlSW5wdXQgPSBmb3JtQWRkLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtX190ZXh0LWlucHV0W25hbWU9XCJ0aXRsZVwiXScpO1xyXG5leHBvcnQgY29uc3QgbGlua0lucHV0ID0gZm9ybUFkZC5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fdGV4dC1pbnB1dFtuYW1lPVwiaW1hZ2UtbGlua1wiXScpO1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1FZGl0QXZhdGFyID0gcG9wdXBFZGl0QXZhdGFyLnF1ZXJ5U2VsZWN0b3IoJy5mb3JtJyk7XHJcbmV4cG9ydCBjb25zdCBhdmF0YXJMaW5rSW5wdXQgPSBmb3JtRWRpdEF2YXRhci5xdWVyeVNlbGVjdG9yKCcuZm9ybV9fdGV4dC1pbnB1dFtuYW1lPVwiYXZhdGFyLWxpbmtcIl0nKTtcclxuXHJcbmV4cG9ydCBjb25zdCBwcm9maWxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGUnKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZWRpdC1idXR0b25cIik7XHJcbmV4cG9ydCBjb25zdCBhZGRCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYWRkLWJ1dHRvblwiKTtcclxuZXhwb3J0IGNvbnN0IGVkaXRBdmF0YXJCdXR0b24gPSBwcm9maWxlLnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fcGhvdG8tZWRpdC1idXR0b25cIik7XHJcblxyXG4vKiogRGVjbGFyYXRpb24gb2YgdGhlIFBob3RvcyAqL1xyXG5leHBvcnQgY29uc3QgcGhvdG9HcmlkU2VsZWN0b3IgPSBcIi5waG90b3NfX2dyaWRcIjtcclxuZXhwb3J0IGNvbnN0IHBob3RvQ2FyZFRlbXBsYXRlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwaG90by1jYXJkX190ZW1wbGF0ZVwiKS5jb250ZW50O1xyXG5cclxuZXhwb3J0IGNvbnN0IGZvcm1zID0gbmV3IE1hcCgpO1xyXG5cclxuLyoqIERlY2xhcmF0aW9uIG9mIHRoZSBTZXR0aW5nIG9iamVjdCBmb3IgY2FyZCB2YWxpZGF0aW9uICovXHJcbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uQ29uZmlnID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIuZm9ybVwiLFxyXG4gIGlucHV0U2VsZWN0b3I6IFwiLmZvcm1fX3RleHQtaW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIuZm9ybV9fc3VibWl0LWJ1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwiZm9ybV9fc3VibWl0LWJ1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJmb3JtX190ZXh0LWlucHV0LWVycm9yX2FjdGl2ZVwiLFxyXG4gIGVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JfdmlzaWJsZVwiXHJcbn07XHJcblxyXG5cclxuIiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuXHJcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCB7IENhcmQgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEZvcm0gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IHsgVXNlckluZm8gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiXHJcbmltcG9ydCB7IFNlY3Rpb24gfSBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCB7IEFwaSB9IGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiXHJcbmltcG9ydCAqIGFzIGNvbnN0YW50cyBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzXCI7XHJcblxyXG5sZXQgY2FyZFRvRGVsZXRlO1xyXG5cclxuLyoqXHJcbiAqIEhhbmRsZXMgY2FyZCBjcmVhdGlvbiBvbiBTZWN0aW9uXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBuYW1lIC0gVGhlIHRpdGxlIG9mIHRoZSBjYXJkXHJcbiAqIEBwYXJhbSB7c3RyaW5nfSBsaW5rIC0gVGhlIGxpbmsgb2YgdGhlIHBob3RvXHJcbiAqL1xyXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmQpIHtcclxuICBjb25zdCBuZXdDYXJkID0gbmV3IENhcmQoY2FyZCwgY29uc3RhbnRzLnBob3RvQ2FyZFRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2ssICBoYW5kbGVDYXJkRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VDbGljayk7XHJcbiAgY29uc3QgcGhvdG9DYXJkID0gbmV3Q2FyZC5jcmVhdGVDYXJkKCk7XHJcbiAgbmV3Q2FyZC51cGRhdGVMaWtlcyhuZXdDYXJkLl9saWtlcywgdXNlckluZm8uX2lkKTtcclxuICByZXR1cm4gcGhvdG9DYXJkO1xyXG59XHJcblxyXG4vKipcclxuICogSGFuZGxlcyBuZXcgcGxhY2UgZm9ybSBzdWJtaXQgKFNlbnQgdG8gcG9wdXBXaXRoRm9ybSlcclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZU5ld1BsYWNlRm9ybVN1Ym1pdChwb3B1cCwgaW5wdXREYXRhKSB7XHJcbiAgY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgICBjYXJkTmFtZTogaW5wdXREYXRhW1widGl0bGVcIl0sXHJcbiAgICBjYXJkTGluazogaW5wdXREYXRhW1wiaW1hZ2UtbGlua1wiXVxyXG4gIH07XHJcbiAgcG9wdXAuc2V0QnV0dG9uVGV4dChcIlNhdmluZy4uLlwiKTtcclxuICBhcGkuc2V0TmV3Q2FyZChjYXJkRGF0YSlcclxuICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShyZXMpO1xyXG4gICAgICBwb3B1cC5jbG9zZSgpO1xyXG4gICAgICB9KVxyXG4gICAgLmNhdGNoKCBlcnIgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgcG9wdXAuc2V0QnV0dG9uVGV4dChcIkNyZWF0ZVwiKTtcclxuICAgIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIG5ldyBwcm9maWxlIGZvcm0gc3VibWl0IChTZW50IHRvIHBvcHVwV2l0aEZvcm0pXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRm9ybVN1Ym1pdChwb3B1cCwgaW5wdXREYXRhKSB7XHJcbiAgcG9wdXAuc2V0QnV0dG9uVGV4dChcIlNhdmluZy4uLlwiKTtcclxuICBhcGkuc2V0VXNlckluZm8oeyBuZXdOYW1lOiBpbnB1dERhdGFbXCJuYW1lXCJdLCBuZXdBYm91dDogaW5wdXREYXRhW1wiYWJvdXQtbWVcIl0gfSlcclxuICAudGhlbiggcmVzID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICBwb3B1cC5jbG9zZSgpO1xyXG4gIH0pXHJcbiAgLmNhdGNoKCBlcnIgPT4ge1xyXG4gICAgY29uc29sZS5sb2coZXJyKTtcclxuICB9KVxyXG4gIC5maW5hbGx5KCgpID0+IHtcclxuICAgIHBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZlXCIpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBEZWxldGVzIHRoZSBzZWxlY3RlZCBDYXJkXHJcbiAqL1xyXG5mdW5jdGlvbiBoYW5kbGVEZWxldGVGb3JtU3VibWl0KHBvcHVwKSB7XHJcbiAgcG9wdXAuc2V0QnV0dG9uVGV4dChcIkRlbGV0aW5nLi4uXCIpO1xyXG4gIGFwaS5kZWxldGVDYXJkKGNhcmRUb0RlbGV0ZS5nZXRJZCgpKVxyXG4gICAgLnRoZW4oKCkgPT4ge1xyXG4gICAgICBjYXJkVG9EZWxldGUuZGVsZXRlQ2FyZCgpO1xyXG4gICAgICBjYXJkVG9EZWxldGU9bnVsbDtcclxuICAgICAgcG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goIGVyciA9PiB7XHJcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICB9KVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBwb3B1cC5zZXRCdXR0b25UZXh0KFwiWWVzXCIpO1xyXG4gICAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIFVwZGF0ZXMgdGhlIGF2YXRhciBwaG90b1xyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEF2YXRhckZvcm1TdWJtaXQocG9wdXAsIGlucHV0RGF0YSkge1xyXG4gIHBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZpbmcuLi5cIik7XHJcbiAgYXBpLnVwZGF0ZUF2YXRhcihpbnB1dERhdGFbXCJhdmF0YXItbGlua1wiXSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJBdmF0YXIgdXBkYXRlZCBcIixyZXMpO1xyXG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICBwb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCggZXJyID0+IHtcclxuICAgICAgY29uc29sZS5sb2coZXJyKTtcclxuICAgIH0pXHJcbiAgICAuZmluYWxseSgoKSA9PiB7XHJcbiAgICAgIHBvcHVwLnNldEJ1dHRvblRleHQoXCJTYXZlXCIpO1xyXG4gIH0pXHJcbn1cclxuXHJcbi8qKlxyXG4gKiBIYW5kbGVzIG9wZW4gcGhvdG8gb24gY2FyZCBjbGljayAoc2VudCB0byBwb3B1cFdpdGhDYXJkKVxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGNhcmQpIHtcclxuICBwaG90b1BvcHVwLm9wZW4oY2FyZC5nZXRJbWFnZUxpbmsoKSwgY2FyZC5nZXROYW1lKCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVDYXJkRGVsZXRlQ2xpY2soY2FyZCkge1xyXG4gIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICBjYXJkVG9EZWxldGUgPSBjYXJkO1xyXG59XHJcblxyXG4vKipcclxuICogQ2FsbHMgdGhlIEFQSSB0byBhZGQvcmVtb3ZlIGEgbGlrZSB0byB0aGUgbGlzdCBkZXBlbmRpbmcgb24gdGhlIGlzTGlrZWQgcGFyYW0uXHJcbiAqIEBwYXJhbSB7Ym9vbGVhbn0gaXNMaWtlZFxyXG4gKi9cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQsIGlzTGlrZWQpIHtcclxuICBpZihpc0xpa2VkKSB7XHJcbiAgICBhcGkuYWRkTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkxpa2UgYWRkZWQgc3VjY2VzZnVsbHlcIiwgcmVzLmxpa2VzKTtcclxuICAgICAgICBjYXJkLnVwZGF0ZUxpa2VzKHJlcy5saWtlcywgdXNlckluZm8uZ2V0SWQoKSk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCggZXJyID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gICAgICB9KVxyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGkucmVtb3ZlTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZyhcIkxpa2UgcmVtb3ZlZCBzdWNjZXNmdWxseVwiLCByZXMubGlrZXMpO1xyXG4gICAgICAgIGNhcmQudXBkYXRlTGlrZXMocmVzLmxpa2VzLCB1c2VySW5mby5nZXRJZCgpKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKCBlcnIgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XHJcbiAgICAgIH0pXHJcbiAgfVxyXG59XHJcblxyXG4vKipcclxuICogRW5hYmxlcyB2YWxpZGF0aW9uIG9uIGFsbCBmb3Jtcy5cclxuICogU2F2ZXMgdGhlIGZvcm1WYWxpZGF0b3JzIG9uIGEgTWFwIGZvciBmdXR1cmUgYWNjZXNzXHJcbiAqL1xyXG5mdW5jdGlvbiBlbmFibGVGb3JtVmFsaWRhdGlvbk9uQWxsRm9ybXMoKSB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBBcnJheS5mcm9tKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoY29uc3RhbnRzLnZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XHJcbiAgZm9ybUxpc3QuZm9yRWFjaCgoZm9ybUVsZW1lbnQpID0+IHtcclxuICAgIGNvbnN0IGZvcm1OYW1lID0gZm9ybUVsZW1lbnQuZ2V0QXR0cmlidXRlKFwibmFtZVwiKTtcclxuICAgIGNvbnN0IGZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25zdGFudHMudmFsaWRhdGlvbkNvbmZpZywgZm9ybUVsZW1lbnQpO1xyXG4gICAgZm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbiAgICBjb25zdGFudHMuZm9ybXMuc2V0KGZvcm1OYW1lLCBmb3JtVmFsaWRhdG9yKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIFNldHRpbmcgdXAgdGhlIEFwaSBjbGFzc1xyXG4gKi9cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiOWQxYzNiNi1jMGY0LTQyMjQtYWQ4Zi00YzgxZWZhM2Y4OWRcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKGNvbnN0YW50cy51c2VyU2VsZWN0b3JzKTtcclxubGV0IHNlY3Rpb247XHJcblxyXG4vKiogVXNlciBhbmQgY2FyZCBpbmZvcm1hdGlvbiBsb2FkaW5nICovXHJcblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcclxuICAudGhlbigoW3VzZXJEYXRhLCBjYXJkc10pID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHVzZXJEYXRhKTtcclxuXHJcbiAgICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oIHtcclxuICAgICAgaXRlbXM6IGNhcmRzLFxyXG4gICAgICByZW5kZXJlcjogcmVuZGVyQ2FyZFxyXG4gICAgfSxcclxuICAgIGNvbnN0YW50cy5waG90b0dyaWRTZWxlY3Rvcik7XHJcbiAgICBzZWN0aW9uLnJlbmRlcmVyKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goIGVyciA9PiB7XHJcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xyXG4gIH0pO1xyXG5cclxuXHJcbi8qKiBQb3B1cCBsb2FkaW5nIGFuZCBldmVudCBsaXN0ZW5lciBzZXR1cCAqL1xyXG5jb25zdCBhZGRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXAtYWRkJywgaGFuZGxlTmV3UGxhY2VGb3JtU3VibWl0KTtcclxuY29uc3QgZWRpdFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oJy5wb3B1cC1lZGl0JywgaGFuZGxlUHJvZmlsZUZvcm1TdWJtaXQpO1xyXG5jb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKCcucG9wdXAtZGVsZXRlJywgaGFuZGxlRGVsZXRlRm9ybVN1Ym1pdCk7XHJcbmNvbnN0IHBob3RvUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoJy5wb3B1cC1waG90bycpO1xyXG5jb25zdCBlZGl0QXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybSgnLnBvcHVwLWVkaXQtYXZhdGFyJywgaGFuZGxlRWRpdEF2YXRhckZvcm1TdWJtaXQpO1xyXG5cclxuLyoqIEVuYWJsZSBWYWxpZGF0aW9uICovXHJcbmVuYWJsZUZvcm1WYWxpZGF0aW9uT25BbGxGb3JtcygpO1xyXG5cclxuXHJcbi8qKiBEZWNsYXJhdGlvbiBvZiB0aGUgZXZlbnQgbGlzdGVuZXJzICovXHJcblxyXG4vKiogQWRkIFBvcHVwIGFuZCBGb3JtICovXHJcbmNvbnN0YW50cy5hZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRQb3B1cC5vcGVuKCk7XHJcbiAgY29uc3RhbnRzLmZvcm1zLmdldChjb25zdGFudHMuZm9ybUFkZE5hbWUpLnJlc2V0VmFsaWRhdGlvbigpO1xyXG59KTtcclxuXHJcblxyXG4vKiogRWRpdCBQb3B1cCBhbmQgRm9ybSAqL1xyXG5jb25zdGFudHMuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IGN1cnJlbnRVc2VySW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgY29uc3RhbnRzLm5hbWVJbnB1dC52YWx1ZSA9IGN1cnJlbnRVc2VySW5mby5uYW1lO1xyXG4gIGNvbnN0YW50cy5kZXNjcmlwdGlvbklucHV0LnZhbHVlID0gY3VycmVudFVzZXJJbmZvLmpvYjtcclxuICBlZGl0UG9wdXAub3BlbigpO1xyXG4gIGNvbnN0YW50cy5mb3Jtcy5nZXQoY29uc3RhbnRzLmZvcm1FZGl0TmFtZSkucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuXHJcbi8qKiBFZGl0IGF2YXRhciBwb3B1cCAqL1xyXG5jb25zdGFudHMuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbiAgY29uc3RhbnRzLmZvcm1zLmdldChjb25zdGFudHMuZm9ybUVkaXRBdmF0YXJOYW1lKS5yZXNldFZhbGlkYXRpb24oKTtcclxufSk7XHJcblxyXG5cclxuXHJcblxyXG4iLCJjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3Iob3B0aW9ucykge1xyXG4gICAgICAgIHRoaXMuX29wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIGdldEluaXRpYWxDYXJkcygpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godGhpcy5fb3B0aW9ucy5iYXNlVXJsK1wiL2NhcmRzL1wiLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuX29wdGlvbnMuaGVhZGVyc1xyXG4gICAgICAgICAgfSlcclxuICAgICAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldE5ld0NhcmQoIHsgY2FyZE5hbWUsIGNhcmRMaW5rIH0pIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX29wdGlvbnMuYmFzZVVybCtcIi9jYXJkcy9cIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG5hbWU6IGNhcmROYW1lLFxyXG4gICAgICAgICAgbGluazogY2FyZExpbmtcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRMaWtlKGlkKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaCh0aGlzLl9vcHRpb25zLmJhc2VVcmwrXCIvY2FyZHMvbGlrZXMvXCIraWQsIHtcclxuICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX29wdGlvbnMuYmFzZVVybCtcIi9jYXJkcy9saWtlcy9cIitpZCwge1xyXG4gICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICBoZWFkZXJzOiB0aGlzLl9vcHRpb25zLmhlYWRlcnNcclxuICAgICAgfSlcclxuICAgICAgLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgICB9XHJcblxyXG4gICAgZGVsZXRlQ2FyZChpZCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2godGhpcy5fb3B0aW9ucy5iYXNlVXJsK1wiL2NhcmRzL1wiK2lkLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHRoaXMuX29wdGlvbnMuaGVhZGVyc1xyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX29wdGlvbnMuYmFzZVVybCtcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKCB7IG5ld05hbWUsIG5ld0Fib3V0IH0pIHtcclxuICAgICAgcmV0dXJuIGZldGNoKHRoaXMuX29wdGlvbnMuYmFzZVVybCtcIi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG5hbWU6IG5ld05hbWUsXHJcbiAgICAgICAgICBhYm91dDogbmV3QWJvdXRcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICAgIH1cclxuXHJcbiAgICB1cGRhdGVBdmF0YXIobGluaykge1xyXG4gICAgICByZXR1cm4gZmV0Y2godGhpcy5fb3B0aW9ucy5iYXNlVXJsK1wiL3VzZXJzL21lL2F2YXRhclwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgaGVhZGVyczogdGhpcy5fb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIGF2YXRhcjogbGlua1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICAgIC50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9XHJcbiAgICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgeyBBcGkgfTtcclxuIiwiY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZVNlbGVjdG9yID0gbmFtZVNlbGVjdG9yO1xyXG4gICAgICAgIHRoaXMuX2pvYlNlbGVjdG9yID0gam9iU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyU2VsZWN0b3IgPSBhdmF0YXJTZWxlY3RvcjtcclxuICAgICAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fbmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9qb2JTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElkKCkge1xyXG4gICAgICBpZih0aGlzLl9pZCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9pZDtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGdldFVzZXJJbmZvKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBqb2I6IHRoaXMuX2pvYkVsZW1lbnQudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyRWxlbWVudC5zcmNcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKCB7IG5hbWUsIGFib3V0LCBfaWQsIGF2YXRhciB9ICkge1xyXG4gICAgICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9qb2JFbGVtZW50LnRleHRDb250ZW50ID0gYWJvdXQ7XHJcbiAgICAgICAgdGhpcy5fYXZhdGFyRWxlbWVudCA9IGF2YXRhcjtcclxuICAgICAgICB0aGlzLl9pZCA9IF9pZDtcclxuICAgIH1cclxufVxyXG5cclxuZXhwb3J0IHsgVXNlckluZm8gfTtcclxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XHJcbiAgICAgICAgdGhpcy5fcGhvdG9Db250YWluZXIgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXAtcGhvdG9fX2NvbnRhaW5lcicpO1xyXG4gICAgICAgIHRoaXMuX3Bob3RvID0gdGhpcy5fcGhvdG9Db250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwLXBob3RvX19waG90bycpO1xyXG4gICAgICAgIHRoaXMuX3RpdGxlID0gdGhpcy5fcGhvdG9Db250YWluZXIucXVlcnlTZWxlY3RvcignLnBvcHVwLXBob3RvX190aXRsZScpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4ocGhvdG9JbWFnZSwgbmFtZSkge1xyXG4gICAgICAgIHRoaXMuX3Bob3RvLnNyYyA9IHBob3RvSW1hZ2U7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX3Bob3RvLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgfVxyXG59XHJcblxyXG5leHBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9OyJdLCJuYW1lcyI6WyJGb3JtVmFsaWRhdG9yIiwiY29uc3RydWN0b3IiLCJzZXR0aW5ncyIsImZvcm0iLCJ0aGlzIiwiX3NldHRpbmdzIiwiX2Zvcm0iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJpbnB1dEVycm9yQ2xhc3MiLCJ0ZXh0Q29udGVudCIsImVycm9yQ2xhc3MiLCJfaGlkZUlucHV0RXJyb3IiLCJyZW1vdmUiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJzb21lIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2J1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwicmVzZXRWYWxpZGF0aW9uIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiQ2FyZCIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNhcmRDbGljayIsImhhbmRsZUxpa2VDbGljayIsIl9pZCIsIm5hbWUiLCJsaW5rIiwibGlrZXMiLCJfbGlrZUJ1dHRvbiIsImNvbnRhaW5zIiwiX2hhbmRsZUxpa2VDbGljayIsIl9oYW5kbGVEZWxldGVDYXJkQ2xpY2siLCJfbmFtZSIsIl9pbWFnZSIsIl9saWtlcyIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlQ2FyZENsaWNrIiwiZ2V0SWQiLCJnZXROYW1lIiwiZ2V0SW1hZ2VMaW5rIiwiY3JlYXRlQ2FyZCIsIl9lbGVtZW50IiwiX2NyZWF0ZU5ld1Bob3RvQ2FyZEVsZW1lbnQiLCJfZGVsZXRlQnV0dG9uIiwiX3Bob3RvIiwiX2FkZEV2ZW50TGlzdGVuZXJzIiwiZGVsZXRlQ2FyZCIsInVwZGF0ZUxpa2VzIiwidXNlcklkIiwibGVuZ3RoIiwiSlNPTiIsInN0cmluZ2lmeSIsImluY2x1ZGVzIiwiX2FkZExpa2VFdmVudExpc3RlbmVyIiwiX2FkZERlbGV0ZUV2ZW50TGlzdGVuZXIiLCJfYWRkT3BlblBob3RvRXZlbnRMaXN0ZW5lciIsInBob3RvQ2FyZCIsImNsb25lTm9kZSIsInBob3RvIiwicGhvdG9UaXRsZSIsInBob3RvTGlrZXMiLCJzcmMiLCJhbHQiLCJfaGFuZGxlTGlrZUV2ZW50IiwiX2hhbmRsZURlbGV0ZUV2ZW50IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwia2V5IiwiY2xvc2UiLCJ0YXJnZXQiLCJfcG9wdXAiLCJkb2N1bWVudCIsIl9jbG9zZUJ1dHRvbiIsImJpbmQiLCJvcGVuIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJyZW1vdmVFdmVudExpc3RlbmVycyIsIl9oYW5kbGVDbGlja09uT3ZlcmxheUNsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVTdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVTdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJfc3VibWl0QnV0dG9uIiwiX2lucHV0cyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJnZXRBdHRyaWJ1dGUiLCJ2YWx1ZSIsInNldEJ1dHRvblRleHQiLCJ0ZXh0IiwiX2hhbmRsZVByb2ZpbGVGb3JtU3VibWl0IiwicmVzZXQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImNsZWFyIiwiaW5uZXJIVE1MIiwiaXRlbSIsImFkZEl0ZW0iLCJjYXJkIiwicHJlcGVuZCIsInBvcHVwRWRpdCIsInBvcHVwQWRkIiwicG9wdXBQaG90byIsInBvcHVwRGVsZXRlIiwicG9wdXBFZGl0QXZhdGFyIiwiZm9ybUVkaXQiLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiZm9ybUFkZCIsInByb2ZpbGUiLCJlZGl0QnV0dG9uIiwiYWRkQnV0dG9uIiwiZWRpdEF2YXRhckJ1dHRvbiIsInBob3RvQ2FyZFRlbXBsYXRlIiwiY29udGVudCIsImZvcm1zIiwiTWFwIiwidmFsaWRhdGlvbkNvbmZpZyIsImZvcm1TZWxlY3RvciIsImNhcmRUb0RlbGV0ZSIsInJlbmRlckNhcmQiLCJuZXdDYXJkIiwiY29uc3RhbnRzIiwiaGFuZGxlQ2FyZERlbGV0ZUNsaWNrIiwidXNlckluZm8iLCJwaG90b1BvcHVwIiwiZGVsZXRlUG9wdXAiLCJpc0xpa2VkIiwiYXBpIiwiYWRkTGlrZSIsInRoZW4iLCJyZXMiLCJjb25zb2xlIiwibG9nIiwiY2F0Y2giLCJlcnIiLCJyZW1vdmVMaWtlIiwib3B0aW9ucyIsIl9vcHRpb25zIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJiYXNlVXJsIiwiaGVhZGVycyIsIl9jaGVja1Jlc3BvbnNlIiwic2V0TmV3Q2FyZCIsImNhcmROYW1lIiwiY2FyZExpbmsiLCJtZXRob2QiLCJib2R5IiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsIm5ld05hbWUiLCJuZXdBYm91dCIsImFib3V0IiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImF1dGhvcml6YXRpb24iLCJuYW1lU2VsZWN0b3IiLCJqb2JTZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVTZWxlY3RvciIsIl9qb2JTZWxlY3RvciIsIl9hdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9qb2JFbGVtZW50IiwiX2F2YXRhckVsZW1lbnQiLCJqb2IiLCJzZWN0aW9uIiwiYWxsIiwidXNlckRhdGEiLCJjYXJkcyIsImFkZFBvcHVwIiwicG9wdXAiLCJpbnB1dERhdGEiLCJjYXJkRGF0YSIsImZpbmFsbHkiLCJlZGl0UG9wdXAiLCJfcGhvdG9Db250YWluZXIiLCJfdGl0bGUiLCJwaG90b0ltYWdlIiwiZWRpdEF2YXRhclBvcHVwIiwiZm9ybUVsZW1lbnQiLCJmb3JtTmFtZSIsImZvcm1WYWxpZGF0b3IiLCJjdXJyZW50VXNlckluZm8iXSwic291cmNlUm9vdCI6IiJ9